# velion_mainboard_firmware
This is the firmware that control the main board and control pannel of the vehicle.

# General logic
Use ESP32 FreeRTOS on Arduino  IDE

there is a mainloop which first read the input, generate event. then iterrate over all state machine and feed them the first event untill all event are consumed. then there the output stage which run the PID step and the output monitoring.

INPUTS Loop (1kHz mini)
Call AceButton and AceRotary to handle buttons and give event

LOGIC FSMs
execute each FSM with the event queue

OUTPUT 
PID V1 

# Pin mapping 
GPIO 36 : Analog input  (THROTTLE_INPUT)
GPIO 39 : Digital input (InterruptEXTGPIO)
GPIO 34 : rotary encoder 1, channel A (POT_SPEED_A)
GPIO 35 : rotary encoder 1, channel B (POT_SPEED_B)
GPIO 32 : rotary encoder 2, channel A (POT_SEATHEATER_A)
GPIO 33 : rotary encoder 2, channel B (POT_SEATHEATER_B)
GPIO 25 : rotary encoder 3, channel A (POT_HANDHEATER_A)
GPIO 26 : rotary encoder 3, channel B (POT_HANDHEATER_B)
GPIO 13 : mosfet gate for defroster load (DEFROSTER_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 15 : mosfet gate for interrior light (INTERRIOR_LIGHT_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 2 : mosfet gate for Blinker LEFT (BLIKER_LEFT_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 0 : mosfet gate for Blinker RIGHT (BLIKER_RIGHT_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 4 : mosfet gate for hand heater load (HANDHEATER_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 16 : mosfet gate for DRL light RIGHT (DRL_RIGHT_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 17 : mosfet gate for DRL light LEFT (DRL_LEFT_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 5 : mosfet gate for SEAT heater load (SEATHEATER_MOSFET_GATE) (drive with PWM duty cycle and ON / OFF)
GPIO 21 : RGBLED_DIN (WS2812B, 5 led, drive them from this pin)
GPIO 23 : SDA (has a pullup of 4k7 aldready )
GPIO 22 : SCL (has a pullup of 4k7 aldready )

I have two MCP23017_SO over I2C whose IO I also want to control over serial like if it was a GPIO of the ESP32.

the one with address 0100001 = 0x21 has : 
GPB0 : Warning_LED
GPB1 : CABLIGHT_LED
GPB2 : DEFROST_LED
GPB3 : TRUNK_LED
GPB4 : BROUILLARD_LED
GPB5 : MAP_LED
GPB6 : DEFROST_INPUT (button, enable the pull-up)
GPB7 : TRUNK_INPUT (button, enable the pull-up)

GPA0 : AUXAUDIO_MOSFET_GATE (drive with ON / OFF)
GPA1 : AUXUSB_MOSFET_GATE (drive with ON / OFF)
GPA2 : LATCH_TRUNK_MOSFTET_GATE (drive with ON / OFF)
GPA3 : POWER_MOSFET_GATE (drive with ON / OFF)


the second MCP with address 0100000 = 0x20

GPB0 : Defroster_ALERT (input that must be configured with interrupt on INTA)
GPB1 : HANDHEATER_ALERT (input that must be configured with interrupt on INTA)
GPB2 : SEATHEATER_ALERT (input that must be configured with interrupt on INTA)
GPB3 : POWERINPUT_ALERT (input that must be configured with interrupt on INTA)
GPB4 : POT_SEATHEATER_X (input switch for the rotary encoder that connect when pressed, dont require a pullup)
GPB5 : POT_HANDHEATER_X (input switch for the rotary encoder that connect when pressed, dont require a pullup)
GPB6 : POT_SPEED_X (input switch for the rotary encoder that connect when pressed, dont require a pullup)
GPB7 : SEAT_INPUT (button, enable the pull-up)

GPA0 : BRAKE_RIGHT_INPUT (button, enable the pull-up)
GPA1 : BRAKE_LEFT_INPUT (button, enable the pull-up)
GPA2 : REVERSE_INPUT (button, enable the pull-up)
GPA3 : FORWARD_INPUT (button, enable the pull-up)
GPA4 : BROUILLARD_INPUT (button, enable the pull-up)
GPA5 : CABLIGHT_INPUT (button, enable the pull-up)
GPA6 : WARNING_INPUT (button, enable the pull-up)
GPA7 : MAP_INPUT (button, enable the pull-up)

I also have a GY-91 with MPU-9250 and BMP280 as a 10 DOF IMU. address for the  MPU9250 shoud led 1101000 = 0x68, BMP : 1110110 = 0x76


# Input event
button/switch pressed
button/switch released short press
button/switch releasd long press
rotary increment / decrement
analog value exceed a threshold
can packet
lateral acceleration exceed a threshold
longitudinal acceleration excced a threshold

# State machines
general rules about timer, if set while running, is start again at the set time but will not generate more than ONE timeout event.
we should have an event queue and a STATE table. the state table is for global state that must be present or absent for something to happen with an event. the event are for every state change.

# STATE MACHINES (FSM DEFINITIONS)

## GLOBAL FSM RULES

* FSMs consume events from a **global event queue**
* Each FSM has **its own timer(s)**

  * If a timer is started while already running, it **restarts**
  * A timer **emits only ONE timeout event**
* `ST_` = current state
* `EV_` = discrete event
* Transitions are **edge-driven only**
* Outputs are applied in the **output stage**, never in input logic

---

## FOG LIGHT FSM

### States

```
ST_FOG_OFF        (default)
ST_FOG_ON
```

### Transitions

```
ST_FOG_OFF -> ST_FOG_ON
  on EV_BTN_BROUILLARD_SHORT
  on EV_BTN_BROUILLARD_LONG

ST_FOG_ON -> ST_FOG_OFF
  on EV_BTN_BROUILLARD_SHORT
  on EV_BTN_BROUILLARD_LONG
```

### Outputs

```
ST_FOG_OFF : OUT_CAN_FOG_STATUS = OFF, OUT_BROUILLARD_LED = OFF
ST_FOG_ON  : OUT_CAN_FOG_STATUS = ON,  OUT_BROUILLARD_LED = ON
```

---

## DEFROSTER FSM

### States

```
ST_DEFROSTER_OFF        (default)
ST_DEFROSTER_ON
ST_DEFROSTER_FAULT_BLINK
```

### Transitions

```
ST_DEFROSTER_OFF -> ST_DEFROSTER_ON
  on EV_BTN_DEFROSTER_SHORT
  on EV_BTN_DEFROSTER_LONG
  start DEFROSTER_ON_TIMER (10 min)

ST_DEFROSTER_ON -> ST_DEFROSTER_OFF
  on EV_BTN_DEFROSTER_SHORT
  on EV_BTN_DEFROSTER_LONG
  on EV_DEFROSTER_ON_TIMEOUT

ST_DEFROSTER_ON -> ST_DEFROSTER_FAULT_BLINK
  on EV_BATTERY_BELOW_30_PERCENT
  on EV_DEFROSTER_FAULT
  start DEFROSTER_FAULT_TIMER (4 sec)

ST_DEFROSTER_FAULT_BLINK -> ST_DEFROSTER_OFF
  on EV_DEFROSTER_FAULT_TIMEOUT
```

### Outputs

```
ST_DEFROSTER_OFF         : OUT_DEFROSTER_MOSFET = OFF, LED OFF
ST_DEFROSTER_ON          : OUT_DEFROSTER_MOSFET = ON,  LED ON
ST_DEFROSTER_FAULT_BLINK : OUT_DEFROSTER_MOSFET = OFF, LED BLINK
```

---

## CABIN LIGHT FSM

### States

```
ST_CABINLIGHT_OFF        (default)
ST_CABINLIGHT_ON
ST_CABINLIGHT_ON_TRUNK
```

### Transitions

```
ST_CABINLIGHT_OFF -> ST_CABINLIGHT_ON
  on EV_BTN_CABLIGHT_SHORT
  on EV_BTN_CABLIGHT_LONG
  start CABINLIGHT_LONG_TIMER (60 min)

ST_CABINLIGHT_OFF -> ST_CABINLIGHT_ON_TRUNK
  on EV_BTN_TRUNK_SHORT
  on EV_BTN_TRUNK_LONG
  start CABINLIGHT_TRUNK_TIMER (5 min)

ST_CABINLIGHT_ON -> ST_CABINLIGHT_OFF
  on EV_BTN_CABLIGHT_SHORT
  on EV_BTN_CABLIGHT_LONG
  on EV_CABINLIGHT_LONG_TIMEOUT

ST_CABINLIGHT_ON_TRUNK -> ST_CABINLIGHT_OFF
  on EV_BTN_CABLIGHT_SHORT
  on EV_BTN_CABLIGHT_LONG
  on EV_CABINLIGHT_TRUNK_TIMEOUT
```

---

## TRUNK FSM

### States

```
ST_TRUNK_LATCHED        (default)
ST_TRUNK_LOCKED
ST_TRUNK_OPENING
ST_TRUNK_LED_FEEDBACK_ON
ST_TRUNK_LED_FEEDBACK_ERROR
```

### Transitions

```
ST_TRUNK_LATCHED -> ST_TRUNK_OPENING
  on EV_BTN_TRUNK_SHORT
  on EV_BTN_TRUNK_LONG
  start TRUNK_ACTION_TIMER (2 sec)

ST_TRUNK_LATCHED -> ST_TRUNK_LOCKED
  on EV_VEHICLE_SPEED_ABOVE_5KPH

ST_TRUNK_LOCKED -> ST_TRUNK_LATCHED
  on EV_VEHICLE_SPEED_BELOW_5KPH

ST_TRUNK_LOCKED -> ST_TRUNK_LED_FEEDBACK_ERROR
  on EV_BTN_TRUNK_SHORT
  on EV_BTN_TRUNK_LONG
  start TRUNK_ERROR_TIMER (4 sec)

ST_TRUNK_OPENING -> ST_TRUNK_LED_FEEDBACK_ON
  on EV_TRUNK_ACTION_TIMEOUT
  start TRUNK_ACTION_TIMER (2 sec)

ST_TRUNK_LED_FEEDBACK_ON -> ST_TRUNK_LATCHED
  on EV_TRUNK_ACTION_TIMEOUT

ST_TRUNK_LED_FEEDBACK_ERROR -> ST_TRUNK_LOCKED
  on EV_TRUNK_ERROR_TIMEOUT
```

---

## WARNING LIGHT FSM

### States

```
ST_WARNING_OFF      (default)
ST_WARNING_BLINK
ST_WARNING_CLEAR
```

### Transitions

```
ST_WARNING_OFF -> ST_WARNING_BLINK
  on EV_BTN_WARNING_SHORT
  on EV_BTN_WARNING_LONG
  start WARNING_CYCLE_TIMER

ST_WARNING_BLINK -> ST_WARNING_OFF
  on EV_BTN_WARNING_SHORT
  on EV_BTN_WARNING_LONG

ST_WARNING_BLINK -> ST_WARNING_CLEAR
  on EV_WARNING_CYCLE_TIMEOUT
  start WARNING_CYCLE_TIMER

ST_WARNING_CLEAR -> ST_WARNING_OFF
  on EV_BTN_WARNING_SHORT
  on EV_BTN_WARNING_LONG

ST_WARNING_CLEAR -> ST_WARNING_BLINK
  on EV_WARNING_CYCLE_TIMEOUT
  start WARNING_CYCLE_TIMER
```

---

## DRIVE DIRECTION FSM (FORWARD / REVERSE)

### States

```
ST_DRIVE_NEUTRAL     (default)
ST_DRIVE_FORWARD
ST_DRIVE_FORWARD_LOCK
ST_DRIVE_REVERSE
ST_DRIVE_REVERSE_LOCK
```

### Transitions

```
ST_DRIVE_NEUTRAL -> ST_DRIVE_FORWARD
  on EV_BTN_FORWARD_SHORT
  on EV_BTN_FORWARD_LONG

ST_DRIVE_NEUTRAL -> ST_DRIVE_REVERSE
  on EV_BTN_REVERSE_SHORT
  on EV_BTN_REVERSE_LONG

ST_DRIVE_FORWARD -> ST_DRIVE_FORWARD_LOCK
  on EV_VEHICLE_SPEED_ABOVE_5KPH

ST_DRIVE_REVERSE -> ST_DRIVE_REVERSE_LOCK
  on EV_VEHICLE_SPEED_ABOVE_5KPH

ST_DRIVE_FORWARD_LOCK -> ST_DRIVE_FORWARD
  on EV_VEHICLE_SPEED_BELOW_5KPH

ST_DRIVE_REVERSE_LOCK -> ST_DRIVE_REVERSE
  on EV_VEHICLE_SPEED_BELOW_5KPH

ST_DRIVE_REVERSE -> ST_DRIVE_FORWARD
  on EV_BTN_FORWARD_SHORT
  on EV_BTN_FORWARD_LONG
  on EV_FORWARD_CHANGE_TIMEOUT

ST_DRIVE_FORWARD -> ST_DRIVE_REVERSE
  on EV_BTN_REVERSE_SHORT
  on EV_BTN_REVERSE_LONG
  on EV_REVERSE_CHANGE_TIMEOUT

ST_DRIVE_FORWARD_LOCK -> ST_DRIVE_FORWARD_LOCK
  on EV_BTN_REVERSE_SHORT
  on EV_BTN_REVERSE_LONG
  start REVERSE_CHANGE_TIMER (10 sec)

ST_DRIVE_REVERSE_LOCK -> ST_DRIVE_REVERSE_LOCK
  on EV_BTN_FORWARD_SHORT
  on EV_BTN_FORWARD_LONG
  start FORWARD_CHANGE_TIMER (10 sec)

ANY DRIVE STATE -> ST_DRIVE_NEUTRAL
  on EV_SEAT_RELEASED_10S
```

---

## BRAKE FSM (DERIVED)

### States

```
ST_BRAKE_LEVEL_0
ST_BRAKE_LEVEL_25
ST_BRAKE_LEVEL_50
ST_BRAKE_LEVEL_100
```

### Transitions

```
ANY -> ST_BRAKE_LEVEL_0    on EV_BRAKE_NONE
ANY -> ST_BRAKE_LEVEL_25  on EV_BRAKE_LEFT_ONLY
ANY -> ST_BRAKE_LEVEL_50  on EV_BRAKE_RIGHT_ONLY
ANY -> ST_BRAKE_LEVEL_100 on EV_BRAKE_BOTH
```

---

## SEAT HEATER FSM

### States

```
ST_SEATHEATER_STANDBY   (default)
ST_SEATHEATER_EDITION
ST_SEATHEATER_ON
```

### Transitions

```
ST_SEATHEATER_STANDBY -> ST_SEATHEATER_EDITION
  on EV_BTN_SEATHEATER_LONG
  start SEATHEATER_EDIT_TIMER (10 sec)

ST_SEATHEATER_EDITION -> ST_SEATHEATER_ON
  on EV_BTN_SEATHEATER_LONG
  start SEATHEATER_ON_TIMER (30 min)

ST_SEATHEATER_EDITION -> ST_SEATHEATER_STANDBY
  on EV_SEATHEATER_EDIT_TIMEOUT

ST_SEATHEATER_STANDBY -> ST_SEATHEATER_ON
  on EV_BTN_SEATHEATER_SHORT
  start SEATHEATER_ON_TIMER (30 min)

ST_SEATHEATER_ON -> ST_SEATHEATER_STANDBY
  on EV_BTN_SEATHEATER_SHORT
  on EV_SEATHEATER_ON_TIMEOUT
```

---

## HAND HEATER FSM

### States

```
ST_HANDHEATER_STANDBY   (default)
ST_HANDHEATER_EDITION
ST_HANDHEATER_ON
```

### Transitions

```
ST_HANDHEATER_STANDBY -> ST_HANDHEATER_EDITION
  on EV_BTN_HANDHEATER_LONG
  start HANDHEATER_EDIT_TIMER (10 sec)

ST_HANDHEATER_ON -> ST_HANDHEATER_EDITION
  on EV_BTN_HANDHEATER_LONG
  start HANDHEATER_EDIT_TIMER (10 sec)

ST_HANDHEATER_EDITION -> ST_HANDHEATER_ON
  on EV_BTN_HANDHEATER_LONG
  start HANDHEATER_ON_TIMER (30 min)

ST_HANDHEATER_EDITION -> ST_HANDHEATER_STANDBY
  on EV_HANDHEATER_EDIT_TIMEOUT

ST_HANDHEATER_STANDBY -> ST_HANDHEATER_ON
  on EV_BTN_HANDHEATER_SHORT
  start HANDHEATER_ON_TIMER (30 min)

ST_HANDHEATER_ON -> ST_HANDHEATER_STANDBY
  on EV_BTN_HANDHEATER_SHORT
  on EV_HANDHEATER_ON_TIMEOUT

ST_HANDHEATER_EDITION -> ST_HANDHEATER_EDITION
  on EV_ROT_HANDHEATER_INC
  on EV_ROT_HANDHEATER_DEC
```

---

## SPEED LIMITER FSM

### States

```
ST_SPEED_LIMIT_EDITION   (default)
ST_ASSIST_COEFF_EDITION
```

### Transitions

```
ST_SPEED_LIMIT_EDITION -> ST_ASSIST_COEFF_EDITION
  on EV_BTN_SPEEDLIMIT_SHORT

ST_ASSIST_COEFF_EDITION -> ST_SPEED_LIMIT_EDITION
  on EV_BTN_SPEEDLIMIT_SHORT
```

---

## MAPPING BUTTON FSM

### States

```
ST_MAPPING_CLEAR   (default)
ST_MAPPING_PRESSED
```

### Transitions

```
ST_MAPPING_CLEAR -> ST_MAPPING_PRESSED
  on EV_BTN_MAPPING_SHORT
  on EV_BTN_MAPPING_LONG
  start MAPPING_BUTTON_TIMER (2 sec)

ST_MAPPING_PRESSED -> ST_MAPPING_CLEAR
  on EV_MAPPING_BUTTON_TIMEOUT
```

---

## USB POWER FSM

### States

```
ST_USB_OFF     (default)
ST_USB_POWERED
ST_USB_GRACE
```

### Transitions

```
ST_USB_OFF -> ST_USB_POWERED
  on EV_SEAT_PRESSED

ST_USB_POWERED -> ST_USB_GRACE
  on EV_SEAT_RELEASED_10S
  start USB_GRACE_TIMER (30 min)

ST_USB_GRACE -> ST_USB_OFF
  on EV_USB_GRACE_TIMEOUT
```

---

## AUDIO OUTPUT

```
OUT_AUXAUDIO_GATE = ON  while seat is pressed
OUT_AUXAUDIO_GATE = OFF on EV_SEAT_RELEASED_10S
```

---

## DRL / BLINKERS

```
OUT_DRL_LEFT  = CAN_DRL_LEFT
OUT_DRL_RIGHT = CAN_DRL_RIGHT

OUT_BLINKER_LEFT  = CAN_BLINKER_LEFT
OUT_BLINKER_RIGHT = CAN_BLINKER_RIGHT
```



### RGB backlight
mapping affect the whole RGB state.
when setting the temperature too.

STATE MAPPING_1
STATE MAPPING_2
STATE MAPPING_3
STATE MAPPING_4
STATE MAPPING_5

STATE TEMPERATURE_LOW
STATE TEMPERATURE_MEDIUM
STATE TEMPERATURE_WARM
STATE TEMPERATURE_HOT
STATE TEMPERATURE_INFERNO



## RAW INPUTS (IN_)

```
IN_THROTTLE_ANALOG
IN_EXT_INTERRUPT

IN_POT_SPEED_A
IN_POT_SPEED_B
IN_POT_SEATHEATER_A
IN_POT_SEATHEATER_B
IN_POT_HANDHEATER_A
IN_POT_HANDHEATER_B

IN_POT_SPEED_SW
IN_POT_SEATHEATER_SW
IN_POT_HANDHEATER_SW

IN_BTN_DEFROSTER
IN_BTN_TRUNK
IN_BTN_CABLIGHT
IN_BTN_WARNING
IN_BTN_FORWARD
IN_BTN_REVERSE
IN_BTN_MAPPING

IN_BTN_BRAKE_LEFT
IN_BTN_BRAKE_RIGHT

IN_SEAT_SENSOR

IN_ALERT_DEFROSTER
IN_ALERT_HANDHEATER
IN_ALERT_SEATHEATER
IN_ALERT_POWERINPUT
```

---

## EVENTS (EV_)

```
EV_BTN_DEFROSTER_SHORT
EV_BTN_DEFROSTER_LONG
EV_BTN_TRUNK_SHORT
EV_BTN_TRUNK_LONG
EV_BTN_CABLIGHT_SHORT
EV_BTN_CABLIGHT_LONG
EV_BTN_WARNING_SHORT
EV_BTN_WARNING_LONG
EV_BTN_FORWARD_SHORT
EV_BTN_FORWARD_LONG
EV_BTN_REVERSE_SHORT
EV_BTN_REVERSE_LONG
EV_BTN_MAPPING_SHORT
EV_BTN_MAPPING_LONG

EV_ROT_SPEED_INC
EV_ROT_SPEED_DEC
EV_ROT_SEATHEATER_INC
EV_ROT_SEATHEATER_DEC
EV_ROT_HANDHEATER_INC
EV_ROT_HANDHEATER_DEC

EV_VEHICLE_SPEED_ABOVE_5KPH
EV_VEHICLE_SPEED_BELOW_5KPH
EV_BATTERY_BELOW_30_PERCENT

EV_SEAT_PRESSED
EV_SEAT_RELEASED_10S

EV_BRAKE_NONE
EV_BRAKE_LEFT_ONLY
EV_BRAKE_RIGHT_ONLY
EV_BRAKE_BOTH

EV_DEFROSTER_FAULT
EV_HANDHEATER_FAULT
EV_SEATHEATER_FAULT
EV_POWERINPUT_FAULT

EV_DEFROSTER_ON_TIMEOUT
EV_DEFROSTER_FAULT_TIMEOUT
EV_CABINLIGHT_LONG_TIMEOUT
EV_CABINLIGHT_TRUNK_TIMEOUT
EV_TRUNK_ACTION_TIMEOUT
EV_TRUNK_ERROR_TIMEOUT
EV_WARNING_CYCLE_TIMEOUT
EV_FORWARD_CHANGE_TIMEOUT
EV_REVERSE_CHANGE_TIMEOUT
EV_SEATHEATER_EDIT_TIMEOUT
EV_SEATHEATER_ON_TIMEOUT
EV_HANDHEATER_EDIT_TIMEOUT
EV_HANDHEATER_ON_TIMEOUT
EV_MAPPING_BUTTON_TIMEOUT
EV_USB_GRACE_TIMEOUT
```

---

## FSM STATES (ST_)

### FOG LIGHT

```
ST_FOG_OFF
ST_FOG_ON
```

### DEFROSTER

```
ST_DEFROSTER_OFF
ST_DEFROSTER_ON
ST_DEFROSTER_FAULT_BLINK
```

### CABIN LIGHT

```
ST_CABINLIGHT_OFF
ST_CABINLIGHT_ON
ST_CABINLIGHT_ON_TRUNK
```

### TRUNK

```
ST_TRUNK_LOCKED
ST_TRUNK_LATCHED
ST_TRUNK_OPENING
ST_TRUNK_LED_FEEDBACK_ON
ST_TRUNK_LED_FEEDBACK_ERROR
```

### WARNING LIGHTS

```
ST_WARNING_OFF
ST_WARNING_BLINK
ST_WARNING_CLEAR
```

### DRIVE DIRECTION

```
ST_DRIVE_NEUTRAL
ST_DRIVE_FORWARD
ST_DRIVE_FORWARD_LOCK
ST_DRIVE_REVERSE
ST_DRIVE_REVERSE_LOCK
```

### BRAKE

```
ST_BRAKE_LEVEL_0
ST_BRAKE_LEVEL_25
ST_BRAKE_LEVEL_50
ST_BRAKE_LEVEL_100
```

### SEAT HEATER

```
ST_SEATHEATER_STANDBY
ST_SEATHEATER_EDITION
ST_SEATHEATER_ON
```

### HAND HEATER

```
ST_HANDHEATER_STANDBY
ST_HANDHEATER_EDITION
ST_HANDHEATER_ON
```

### SPEED LIMITER

```
ST_SPEED_LIMIT_EDITION
ST_ASSIST_COEFF_EDITION
```

### MAPPING BUTTON

```
ST_MAPPING_CLEAR
ST_MAPPING_PRESSED
```

### USB POWER

```
ST_USB_OFF
ST_USB_POWERED
ST_USB_GRACE
```

### RGB BACKLIGHT

```
ST_RGB_MAPPING_1
ST_RGB_MAPPING_2
ST_RGB_MAPPING_3
ST_RGB_MAPPING_4
ST_RGB_MAPPING_5

ST_RGB_TEMP_LOW
ST_RGB_TEMP_MEDIUM
ST_RGB_TEMP_WARM
ST_RGB_TEMP_HOT
ST_RGB_TEMP_INFERNO
```

---

## OUTPUTS (OUT_)

```
OUT_DEFROSTER_MOSFET
OUT_CABINLIGHT_MOSFET
OUT_HANDHEATER_MOSFET
OUT_SEATHEATER_MOSFET

OUT_BLINKER_LEFT
OUT_BLINKER_RIGHT
OUT_DRL_LEFT
OUT_DRL_RIGHT

OUT_WARNING_LED
OUT_CABLIGHT_LED
OUT_DEFROST_LED
OUT_TRUNK_LED
OUT_BROUILLARD_LED
OUT_MAP_LED

OUT_AUXAUDIO_GATE
OUT_AUXUSB_GATE
OUT_TRUNK_LATCH_GATE
OUT_POWER_GATE

OUT_RGB_BACKLIGHT

OUT_CAN_FOG_STATUS
OUT_CAN_WARNING_STATUS
OUT_CAN_DRIVE_DIRECTION
OUT_CAN_SPEED_LIMIT
OUT_CAN_ASSIST_COEFF

OUT_PID_SEATHEATER_DUTY
OUT_PID_HANDHEATER_DUTY

OUT_BEEP
```
